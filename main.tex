\documentclass{article}

\usepackage{graphicx}
\usepackage{float}
\usepackage[utf8]{inputenc}
\usepackage[OT4]{fontenc}
\usepackage[polish]{babel}
\usepackage{cancel}
\usepackage{amsmath}

\begin{document}
\section{Aproksymacja}
\subsection{Aproksymacja średniokwadratowa dla funkcji zadanej dyskretnie.}
Dla danej funkcji:
\begin{table}[H]
\begin{tabular}{|c|c|}
\hline
x  & f(x) \\ \hline
-1 & 0    \\ \hline
0  & -1   \\ \hline
1  & 0    \\ \hline
2  & 1    \\ \hline
\end{tabular}%

\end{table}
Znajdź jej aproksymacje metodą średniokwadratową dla postaci:\\
\subsubsection{$f(x)=ax+bx^2$}
$f(a,b) = ((y(-1)-0)^2 + (y(0)- -1)^2 + (y(1)-0)^2 + (y(2)-1)^2)*\frac{1}{4}$\\
$f(a,b) = ((-a+b)^2 + (1)^2 + (a+b)^2 + (2a+4b-1)^2)*/frac{1}{4}$\\
$f(a,b) = (a^2+b^2\cancel{-2ab} + 1 + a^2+b^2\cancel{+2ab} + 4a^2+16ab-4a+16b^2-8b+1)*\frac{1}{4}$\\
$f(a,b) = (\frac{3}{2}a^2+4ab-a+\frac{9}{2}b^2-2b+\frac{1}{2})$\\
$\frac{d}{da}f(a,b)=3a+4b-1$\\
$\frac{d}{db}f(a,b)=4a+9b-2$\\

\begin{equation*}\begin{cases}
    12a+16b-4=0 \\
    16a+36b-8=0
\end{cases}\end{equation*}

\begin{equation*}\begin{cases}
    a=\frac{1}{11}\\
    b=\frac{2}{11}
\end{cases}\end{equation*}\\


Uwaga: Teoretycznie trzeba robić kolejne kroki, ale łatwo pokazać, że większe b stworzy dużo mniej dokładne wyniki, a te wartości to jedyne rozwiązania. Dodatkowo nie trzeba dzielić całości przez 4, bo i tak w pochodnych to nie ma znaczenia, bo po 2giej stronie jest 0 i można sobie pomnożyć.

\subsubsection{$f(x)=a+bx^3$}
$f(a,b) = (y(-1)-0)^2 + (y(0)- -1)^2 + (y(1)-0)^2 + (y(2)-1)^2$\\
$f(a,b) = (a-b)^2 + (a- -1)^2 + (a+b)^2 + (a+8b-1)^2$\\
$f(a,b) = 4a^2+16ab+66b^2-16b+2$
$\frac{d}{da}f(a,b)=8a+16b$\\
$\frac{d}{db}f(a,b)=16a+132b-16$\\

\begin{equation*}\begin{cases}
    8a+16b=0 |*\frac{1}{2}\\
    16a+132b-16=0  |*\frac{1}{4}
\end{cases}\end{equation*}

\begin{equation*}\begin{cases}
    4a+8b=0\\
    4a+33b-4=0
\end{cases}\end{equation*}

\begin{equation*}\begin{cases}
    a=-\frac{8}{25}\\
    b=\frac{4}{25}
\end{cases}\end{equation*}

\subsubsection{$f(x) = ax+b$}
$f(a,b)=(-a+b-0)^2+(b-(-1))^2+(a+b-0)^2+(2a+b-1)^2$\\
$f(a,b)=6a^2+4ab-4a+4b^2+2$\\
$\frac{d}{da}f(a,b)=12a+4b-4$\\
$\frac{d}{db}f(a,b)=4a+8b$\\

\begin{equation*}\begin{cases}
    12a+4b-4=0\\
    4a+8b=0
\end{cases}\end{equation*}

\begin{equation*}\begin{cases}
    a=\frac{2}{5}\\
    b=-\frac{1}{5}
\end{cases}\end{equation*}

\section{Lagrange}
\subsection{Wyznacz współczynniki wielomianu}
Dla następujących danych:
\begin{table}[H]
\begin{tabular}{|c|c|}
\hline
x  & f(x) \\ \hline
-4 & 2    \\ \hline
-2 & -3   \\ \hline
3  & 2    \\ \hline
6  & -3   \\ \hline
\end{tabular}
\end{table}
wyznacz współczynniki wielomianu Langrange'a\\
$l0(x)=\frac{x- (-2)}{-4- (-2)}*\frac{x-3}{-4-3}*\frac{x-6}{-4-6} = -\frac{1}{140}x^3+\frac{1}{20}x^2-\frac{9}{35}$\\ %-4
$l1(x)=\frac{x- (-4)}{-2- (-4)}*\frac{x-3}{-2-3}*\frac{x-6}{-2-6} = \frac{1}{80}x^3-\frac{1}{16}x^2-\frac{9}{40}x+\frac{9}{10}$\\ %(-2)
$l2(x)=\frac{x- (-4)}{3- (-4)}*\frac{x- (-2)}{3- (-2)}*\frac{x-6}{3-6} = -\frac{1}{105}x^3+\frac{4}{15}x+\frac{16}{35}$\\ %3
$l3(x)=\frac{x- (-4)}{6- (-4)}*\frac{x- (-2)}{6- (-2)}*\frac{x-3}{6-3} = \frac{1}{240}x^3+\frac{1}{80}x^2-\frac{1}{24}x-\frac{1}{10}$\\ %6
$L(x)=2*l0(x)+-3*l1(x)+2*l2(x)+-3*l3(x)$\\
$L(x)=-\frac{1}{12}x^3+\frac{1}{4}x^2+\frac{4}{3}x-2$
Uwaga: Można sprawdzić, czy wielomian jest poprawnie obliczony wstawiając do niego wartości z tabelki. Powinny wychodzić identyczne.
\subsection{Wyznacz pochodną w punkcie}
Dla danych:
\begin{table}[H]
\begin{tabular}{|c|c|}
\hline
x  & f(x) \\ \hline
-1 & -1   \\ \hline
1  & 0    \\ \hline
3  & -1   \\ \hline
4  & 1    \\ \hline
\end{tabular}
\end{table}
Wyznacz pochodną dla x=1 i porównaj wynik w tym punkcie na podstawie ilorazu różnicowego centralnego.\\
$l0(X)=\frac{x-1}{-1-1}*\frac{x-3}{-1-3}*\frac{x-4}{-1-4} = \frac{1}{40}(-x^3+8x^2-19x+12)$\\
$l1(X)=\frac{x- (-1)}{1- (-1)}*\frac{x-3}{1-3}*\frac{x-4}{1-4} = \frac{1}{12}(x^3-6x^2+5x+12)$\\
$l2(X)=\frac{x- (-1)}{3- (-1)}*\frac{x-1}{3-1}*\frac{x-4}{3-4} = \frac{1}{8}(-x^3+4x^2+x-4)$\\
$l3(X)=\frac{x- (-1)}{4- (-1)}*\frac{x-1}{4-1}*\frac{x-3}{4-3} = \frac{1}{15}(x^3-3x^2-x+3)$\\
$L(x)=-1*l0(x)+\cancel{0*l1(x)}+-1*l2(x)+1*l3(x)$\\
$L(x)=\frac{13x^3}{60}-\frac{9x^2}{10}+\frac{17x}{60}+\frac{2}{5}$\\
$L'(x)=\frac{13x^2}{20}-\frac{9x}{5}+\frac{17}{60}$\\
$L'(1)=\frac{13}{20}-\frac{9}{5}+\frac{17}{60}=-\frac{13}{15}$

\end{document}