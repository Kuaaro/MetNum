\documentclass{article}

\usepackage{graphicx}
\usepackage{float}
\usepackage[utf8]{inputenc}
\usepackage[OT4]{fontenc}
\usepackage[polish]{babel}
\usepackage{cancel}
\usepackage{amsmath}
\usepackage[legalpaper, margin=2cm]{geometry}
\usepackage{multirow}

\setlength{\parindent}{0pt}

\begin{document}

\tableofcontents

\section{Aproksymacja}
\subsection{Aproksymacja średniokwadratowa dla funkcji zadanej dyskretnie.}
Dla danej funkcji:
\begin{table}[H]
\begin{tabular}{|c|c|}
\hline
x  & f(x) \\ \hline
-1 & 0    \\ \hline
0  & -1   \\ \hline
1  & 0    \\ \hline
2  & 1    \\ \hline
\end{tabular}%
\end{table}
Znajdź jej aproksymacje metodą średniokwadratową dla postaci:\\
\subsubsection{$f(x)=ax+bx^2$}
$f(a,b) = ((y(-1)-0)^2 + (y(0)- -1)^2 + (y(1)-0)^2 + (y(2)-1)^2)*\frac{1}{4}$\\
$f(a,b) = ((-a+b)^2 + (1)^2 + (a+b)^2 + (2a+4b-1)^2)*\frac{1}{4}$\\
$f(a,b) = (a^2+b^2\cancel{-2ab} + 1 + a^2+b^2\cancel{+2ab} + 4a^2+16ab-4a+16b^2-8b+1)*\frac{1}{4}$\\
$f(a,b) = (\frac{3}{2}a^2+4ab-a+\frac{9}{2}b^2-2b+\frac{1}{2})$\\
$\frac{d}{da}f(a,b)=3a+4b-1$\\
$\frac{d}{db}f(a,b)=4a+9b-2$\\

\begin{equation*}\begin{cases}
    12a+16b-4=0 \\
    16a+36b-8=0
\end{cases}\end{equation*}

\begin{equation*}\begin{cases}
    a=\frac{1}{11}\\
    b=\frac{2}{11}
\end{cases}\end{equation*}\\


Uwaga: Teoretycznie trzeba robić kolejne kroki, ale łatwo pokazać, że większe b stworzy dużo mniej dokładne wyniki, a te wartości to jedyne rozwiązania. Dodatkowo nie trzeba dzielić całości przez 4, bo i tak w pochodnych to nie ma znaczenia, bo po 2giej stronie jest 0 i można sobie pomnożyć.

\subsubsection{$f(x)=a+bx^3$}
$f(a,b) = (y(-1)-0)^2 + (y(0)- -1)^2 + (y(1)-0)^2 + (y(2)-1)^2$\\
$f(a,b) = (a-b)^2 + (a- -1)^2 + (a+b)^2 + (a+8b-1)^2$\\
$f(a,b) = 4a^2+16ab+66b^2-16b+2$
$\frac{d}{da}f(a,b)=8a+16b$\\
$\frac{d}{db}f(a,b)=16a+132b-16$\\

\begin{equation*}\begin{cases}
    8a+16b=0 |*\frac{1}{2}\\
    16a+132b-16=0  |*\frac{1}{4}
\end{cases}\end{equation*}

\begin{equation*}\begin{cases}
    4a+8b=0\\
    4a+33b-4=0
\end{cases}\end{equation*}

\begin{equation*}\begin{cases}
    a=-\frac{8}{25}\\
    b=\frac{4}{25}
\end{cases}\end{equation*}

\subsubsection{$f(x) = ax+b$}
$f(a,b)=(-a+b-0)^2+(b-(-1))^2+(a+b-0)^2+(2a+b-1)^2$\\
$f(a,b)=6a^2+4ab-4a+4b^2+2$\\
$\frac{d}{da}f(a,b)=12a+4b-4$\\
$\frac{d}{db}f(a,b)=4a+8b$\\

\begin{equation*}\begin{cases}
    12a+4b-4=0\\
    4a+8b=0
\end{cases}\end{equation*}

\begin{equation*}\begin{cases}
    a=\frac{2}{5}\\
    b=-\frac{1}{5}
\end{cases}\end{equation*}

\subsection{Aproksymacja średniokwadratowa dla funkcji w przedziale}
Dla funkcji $f(x)=x^4, x\in<0; 1>$ Znajdź aproksymacją średniokwadratowa funkcji $f(x)=ax^2$. Znajdź, dla jakiej wartości x błąd aproksymacji będzie największy.\\
$f(a) = \int_{0}^{1}(ax^2-x^4)^2dx$\\
$f(a) = \frac{a^2}{5}-\frac{2a}{7}+\frac{1}{9}$\\
$\frac{d}{da}f(a) = \frac{2a}{5}-\frac{2}{7}$

\begin{equation*}\begin{cases}
    \frac{2a}{5}-\frac{2}{7} = 0
\end{cases}\end{equation*}

\begin{equation*}\begin{cases}
    a = \frac{5}{7}
\end{cases}\end{equation*}

Musimy znaleźć $max|(\frac{5}{7}x^2-x^4)|\in\{0; 1\}$, ale że nie chce mi się bawić w pochodną dla wartości bezwzględnej, znajdę minima i maksima funkcji i wezmę wartość bezwzględną z nich.\\
$f(x) = \frac{5}{7}x^2$\\
$g(x) = \frac{5}{7}x^2-x^4$\\
$\frac{d}{dx}g(x) = \frac{10}{7}x-4x^3$

\begin{equation*}\begin{cases}
    \frac{20}{7}x-4x^3 = 0
\end{cases}\end{equation*}

\begin{equation*}\begin{cases}
    x \in \{-\sqrt{\frac{5}{7}}, 0, \sqrt{\frac{5}{7}}\}
\end{cases}\end{equation*}

$-\sqrt{\frac{5}{7}}<0$, więc jest poza przedziałem. Należy równierz dodać 0 i 1, jako początek i koniec przedziału.

\begin{equation*}\begin{cases}
    |f(0)| = 0\\
    |f(\sqrt{\frac{5}{7}})| \approx 0.51\\
    |f(1)| \approx 0.43
\end{cases}\end{equation*}

Dla $x=\sqrt{\frac{5}{7}}$ aproksymacja jest obarczona największym błędem.

\subsection{Jednostajna (Taylora)}
\textbf{UWAGA: Wynik teoretyczny inny niż praktyczne (gorszy), nie przepisywać bezmyślnie}
W aproksymacji jednostajnej należy stworzyć jak najmniejszy maksymalny błąd.\\
Szereg Taylora n-tego stopnia = $\sum_{i=0}^{n}(\frac{\frac{d^i}{dx^i}f(x_0)}{i!}(x-\delta)^i)$, gdzie $x_0$ to środek przedziału, $\delta$ to promień przedziału, czyli długość/2.

\subsubsection{$y=\sqrt{x}, a\in <0;2>$}
$x_0=1,\:\delta=1$\\
Dla 2giego stopnia szereg Taylora wygląda $f(x)=\sqrt{1}+\frac{1}{2\sqrt{1}}(x-1)+\frac{-\frac{1}{4x^\frac{3}{2}}}{2!}(x-1)^2=-\frac{x^2}{8}+\frac{3x}{4}+\frac{3}{8}$.\\
Rozwiązanie teoretycznie poprawne, ale jak na desmosie patrzę na błąd funkcji, to dla mniejszego c błąd maksymalny jest mniejszy. Ekstrema lokalne są w 0 i 2. Najlepsza praktyczna wartość, jaką znalazłem była dla $c=\frac{\sqrt{2}-1}{2}$

\begin{equation*}\begin{cases}
    \frac{1}{2\sqrt{x}}-2ax-b=0
\end{cases}\end{equation*}



\section{Lagrange}
\subsection{Wyznacz współczynniki wielomianu}
Dla następujących danych:
\begin{table}[H]
\begin{tabular}{|c|c|}
\hline
x  & f(x) \\ \hline
-4 & 2    \\ \hline
-2 & -3   \\ \hline
3  & 2    \\ \hline
6  & -3   \\ \hline
\end{tabular}
\end{table}
Wyznacz współczynniki wielomianu Langrange'a\\
$l0(x)=\frac{x- (-2)}{-4- (-2)}*\frac{x-3}{-4-3}*\frac{x-6}{-4-6} = -\frac{1}{140}x^3+\frac{1}{20}x^2-\frac{9}{35}$\\ %-4
$l1(x)=\frac{x- (-4)}{-2- (-4)}*\frac{x-3}{-2-3}*\frac{x-6}{-2-6} = \frac{1}{80}x^3-\frac{1}{16}x^2-\frac{9}{40}x+\frac{9}{10}$\\ %(-2)
$l2(x)=\frac{x- (-4)}{3- (-4)}*\frac{x- (-2)}{3- (-2)}*\frac{x-6}{3-6} = -\frac{1}{105}x^3+\frac{4}{15}x+\frac{16}{35}$\\ %3
$l3(x)=\frac{x- (-4)}{6- (-4)}*\frac{x- (-2)}{6- (-2)}*\frac{x-3}{6-3} = \frac{1}{240}x^3+\frac{1}{80}x^2-\frac{1}{24}x-\frac{1}{10}$\\ %6
$L(x)=2*l0(x)+-3*l1(x)+2*l2(x)+-3*l3(x)$\\
$L(x)=-\frac{1}{12}x^3+\frac{1}{4}x^2+\frac{4}{3}x-2$\\
Uwaga: Można sprawdzić, czy wielomian jest poprawnie obliczony wstawiając do niego wartości z tabelki. Powinny wychodzić identyczne wartości f(x).
\subsection{Wyznacz pochodną w punkcie}
Dla danych:
\begin{table}[H]
\begin{tabular}{|c|c|}
\hline
x  & f(x) \\ \hline
-1 & -1   \\ \hline
1  & 0    \\ \hline
3  & -1   \\ \hline
4  & 1    \\ \hline
\end{tabular}
\end{table}
Wyznacz pochodną dla x=1 i porównaj wynik w tym punkcie na podstawie ilorazu różnicowego centralnego.\\
\subsubsection{Używając wielomianu}
$l0(X)=\frac{x-1}{-1-1}*\frac{x-3}{-1-3}*\frac{x-4}{-1-4} = \frac{1}{40}(-x^3+8x^2-19x+12)$\\
$l1(X)=\frac{x- (-1)}{1- (-1)}*\frac{x-3}{1-3}*\frac{x-4}{1-4} = \frac{1}{12}(x^3-6x^2+5x+12)$\\
$l2(X)=\frac{x- (-1)}{3- (-1)}*\frac{x-1}{3-1}*\frac{x-4}{3-4} = \frac{1}{8}(-x^3+4x^2+x-4)$\\
$l3(X)=\frac{x- (-1)}{4- (-1)}*\frac{x-1}{4-1}*\frac{x-3}{4-3} = \frac{1}{15}(x^3-3x^2-x+3)$\\
$L(x)=-1*l0(x)+\cancel{0*l1(x)}+-1*l2(x)+1*l3(x)$\\
$L(x)=\frac{13x^3}{60}-\frac{9x^2}{10}+\frac{17x}{60}+\frac{2}{5}$\\
$L'(x)=\frac{13x^2}{20}-\frac{9x}{5}+\frac{17}{60}$\\
$L'(1)=\frac{13}{20}-\frac{9}{5}+\frac{17}{60}=-\frac{13}{15}$
\subsubsection{Używając ilorazu różnicowego centralnego}
Uwaga: Sekcja zrobiona przy pomocy AI, ale pokrywa się mniej-więcej z książką\\
Znajdujemy takie punkty, żeby $|x-x_1|=|x-x_2|$, dla tego przypadku $x_1 = -1$ i $x_2 = 3$. Odległość od x $h=2$\\
$f'(1)=\frac{f(x+h)-f(x-h)}{2h}=\frac{f(3)-f(-1)}{2*2}=\frac{-1-(-1)}{4}=0$\\
Co jest różne w porównaniu do wartości wyliczonej z wielomianu. Jest to jednak do przewidzenia, ponieważ jeżeli wyświetlimy wykres wielomianu, to nie jest to maksimum lokalne, ale wg funkcji dyskretnej jest.

\section{Newton}
Dla danej funkcji:
\begin{table}[H]
\begin{tabular}{|c|c|}
\hline
x  & f(x) \\ \hline
-1 & 0    \\ \hline
0  & -1   \\ \hline
1  & 0    \\ \hline
2  & 1    \\ \hline
\end{tabular}%
\end{table}
$n0=0$\\
$n1=(\cancel{\frac{0}{-1-0}} + \frac{-1}{0- (-1)})(x-(-1))$\\
$n2=(\cancel{\frac{0}{(-1-0)(-1-1)}}+\frac{-1}{(0-(-1))(0-1)}+\cancel{\frac{0}{(1-(-1))(1-0)}})(x-(-1))(x-0)$\\
$n3=(\cancel{\frac{0}{(-1-0)(-1-1)(-1-2)}}+\frac{-1}{(0-(-1))(0-1)(0-2)}+\cancel{\frac{0}{(1-(-1))(1-0)(1-2)}}+\frac{1}{(2-(-1))(2-0)(2-1)})(x-(-1))(x-0)(x-1)$\\
$P(x)=n0+n1+n2+n3$\\
$P(x)=\frac{1}{3}(-x^3+3x^2+x-3)$\\
Ogólnie Newton to suma wielomianów k-tego stopnia, gdzie nk to suma $\frac{f(x_k)}{x_k-x_n}$ pomnożona przez $(x-x_n)$, gdzie $n \in \{1,2...,k\}$ (zerowy wielomian to $f(x_0)$).

\section{Normy macierzy}
$A=\begin{bmatrix} 1 & 2 & 3 \\ 4 & 5 & 6 \\ 7 & 8 & 9 \end{bmatrix}$\\
\subsection{$||A||_1$}
Maksymalna suma wartości bezwzględnych w każdej z kolumn.\\
$||A||_1=max\{|1|+|4|+|7|=12, |2|+|5|+|8|=15, |3|+|6|+|9|=18\}$\\
$||A||_1=18$

\subsection{$||A||_2$}
$\sqrt{max\{\lambda\}}$, gdzie $\lambda$ to wartości dla których $det(\lambda I - A^TA)=0$\\
$A^TA=\begin{bmatrix} 1 & 4 & 7 \\ 2 & 5 & 8 \\ 3 & 6 & 9 \end{bmatrix}\begin{bmatrix} 1 & 2 & 3 \\ 4 & 5 & 6 \\ 7 & 8 & 9 \end{bmatrix}=\begin{bmatrix} 66 & 78 & 90 \\ 78 & 93 & 108 \\ 90 & 108 & 126 \end{bmatrix}$\\
$det(\begin{bmatrix} \lambda & 0 & 0 \\ 0 & \lambda & 0 \\ 0 & 0 & \lambda \end{bmatrix}-\begin{bmatrix} 66 & 78 & 90 \\ 78 & 93 & 108 \\ 90 & 108 & 126 \end{bmatrix})=0$\\
$\lambda^3-285\lambda^2+324\lambda=0$\\
$\lambda \in \{0, \frac{285-3\sqrt{8881}}{2}, \frac{285+3\sqrt{8881}}{2}\}$\\
$max\{\lambda\}=\frac{285+3\sqrt{8881}}{2}$\\
$||A||_2=\sqrt{\frac{285+3\sqrt{8881}}{2}}\approx 16.85$

\subsection{$||A||_\infty$}
Maksymalna suma wartości bezwzględnych w każdym z wierszy.\\
$||A||_\infty=max\{|1|+|2|+|3|=6, |4|+|5|+|6|=15, |7|+|8|+|9|=24\}$\\
$||A||_\infty=24$

\subsection{$||A||_F$}
Pierwiastek sumy kwadratów wszystkich elementów w macierzy.\\
$||A||_F=\sqrt{1^2+2^2+3^2+4^2+5^2+6^2+7^2+8^2+9^2}$\\
$||A||_F=16.88$

$\sqrt[7]{a}\\x_{i+1}=\frac{6x_i+\frac{a}{x^6_i}}{7}$

\section{Metody rozwiązywania układów}
\subsection{Prosta (Nieliniowe)}

Wzór: $0=f(x) => x_{n+1}=\phi (x_n), 0 < |\phi '(x_n)| < 1$.

\subsubsection{$f(x)=ln(x)-\frac{1}{x}$}

$ln(x)=\frac{1}{x}$\\
$e^{ln(x)}=e^{\frac{1}{x}}$\\
$x=e^\frac{1}{x}$\\
$x_0=2$\\
$x_1=e^\frac{1}{x_0}=1.6487212707$\\
$x_2=e^\frac{1}{x_1}=1.8340573792$\\
$x_3=e^\frac{1}{x_2}=1.72502097856$\\
$x_4=e^\frac{1}{x_3}=1.78550822551$\\
$x_5=e^\frac{1}{x_4}=1.75078564631$\\
$x_6=e^\frac{1}{x_5}=1.77034093906$\\
$x_7=e^\frac{1}{x_6}=1.75920666162$\\
$x_8=e^\frac{1}{x_7}=1.76550725831$\\
$x_9=e^\frac{1}{x_8}=1.76192938968$\\
$x_{10}=e^\frac{1}{x_9}=1.76395709418$\\

\subsubsection{$f(x)=e^x-\frac{1}{x}$}
$\frac{1}{x}=e^x$\\
$x=\frac{1}{e^x}$\\
$x_0=0$\\
$x_1=\frac{1}{e^{x_0}}=1$\\
$x_2=\frac{1}{e^{x_1}}=0.367879441171$\\
$x_3=\frac{1}{e^{x_2}}=0.692200627556$\\
$x_4=\frac{1}{e^{x_3}}=0.500473500563$\\
$x_5=\frac{1}{e^{x_4}}=0.606243535086$\\
$x_6=\frac{1}{e^{x_5}}=0.545395785975$\\
$x_7=\frac{1}{e^{x_6}}=0.579612335503$\\
$x_8=\frac{1}{e^{x_7}}=0.560115461361$\\
$x_9=\frac{1}{e^{x_8}}=0.57114311508$\\
$x_{10}=\frac{1}{e^{x_9}}=0.564879347391$\\
$x_{11}=\frac{1}{e^{x_{10}}}=0.568428725029$\\
$x_{12}=\frac{1}{e^{x_{11}}}=0.566414733147$\\
$x_{13}=\frac{1}{e^{x_{12}}}=0.567556637328$\\

\subsection{Metoda Newtona (Nieliniowe)}
Wzór: $N(x)=x-\frac{f(x)}{f'(x)}$\\
Uwaga: chyba można znaleźć punkt $g(x)=0$ z $g(x)=\frac{f(x)}{f'(x)}$, wtedy tam jest albo $f(x)=0$ albo $f(x)=\pm \infty$, przynajmniej tak działa dla poniższych przykładów, ale wtedy to nie jest metoda Newtona chyba.
\subsubsection{$f(x)=ln(x)-\frac{1}{x}$}
$\frac{d}{dx}f(x)=f'(x)=\frac{x-1}{x^2}$\\
$x_0=2$\\
$x_1=N(x_0)=1.74247042592$\\
$x_2=N(x_1)=1.76305587394$\\
$x_3=N(x_2)=1.76322282359$\\
$x_4=N(x_3)=1.76322283435$\\
Nie chce mi się dalej robić, ale punkt zerowy jest w około $x=1.7632228$, co daje $f(1.7632228)=-3*10^-8$\\

\subsubsection{$f(x)=e^x+\frac{1}{x}$}
$\frac{d}{dx}f(x)=f'(x)=e^x-\frac{1}{x^2}$\\
$x_0=1$\\
$x_1=N(x_0)=-1.16395341374$\\
$x_2=N(x_1)=-2.44811693124$\\
$x_3=N(x_2)=-6.45348240853$\\
$x_4=N(x_3)=-13.2898033355$\\

Dalej nie robię, bo $x_n-x_{n-1}$ się zwiększa a nie zmniejsza, czyli funkcja nie przecina punktu 0.

\subsubsection{$f(x)=e^x-\frac{1}{x}$}
$\frac{d}{dx}f(x)=f'(x)=e^x+\frac{1}{x^2}$\\
$x_0=1$\\
$x_1=N(x_0)=0.53788284274$\\
$x_2=N(x_1)=0.566277007666$\\
$x_3=N(x_2)=0.567142580362$\\
$x_4=N(x_3)=0.567143290409$\\

Punkt zerowy znajduje się mniej więcej w x=0.56714

\subsection{Jacobiego (liniowe)}
Wzór: $x_{i+1}=(1-D^{-1}A)x_i+D^{-1}b$\\
Uwaga: Ta metoda działa tylko jeśli w każdym wierszu i kolumnie suma modułów elementów niediagonalnych jest mniejsza niż moduł elementu diagonalnego.
\subsubsection{\begin{equation*}\begin{cases}
    4x_1-2x_2=1\\
    -8x_1+x_2=3
\end{cases}\end{equation*}}
Dla tych danych nie możemy zastosować metody Jacobiego, ponieważ $|4|>|-2|$, ale $|1|\cancel{>}|-8|$. Teoretycznie możemy dodać do 2giego równania 2*pierwsze, wtedy warunek będzie spełniony:

\begin{equation*}\begin{cases}
    4x_1-2x_2=1\\
    0x_1-3x_2=5
\end{cases}\end{equation*}

Z czego wynika że:
\begin{equation*}\begin{cases}
    x_1=-\frac{7}{12}\\
    x_2=-\frac{5}{3}
\end{cases}\end{equation*}

Ale udajemy że jesteśmy komputerami i tego nie wiemy.

Zapisujemy równanie do równania z macierzami:\\
$Ax=b\:=>\:\begin{bmatrix} 4 & -2 \\ 0 & -3 \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} = \begin{bmatrix} 1 \\ 5 \end{bmatrix}$

Jako wektor startowy przyjmiemy:\\
$x_0=\begin{bmatrix} 0 \\ 0 \end{bmatrix}$

Tworzymy macierz $D^{-1}$ (Odwrotności diagonalnych macierzy powyżej):\\
$D^{-1}=\begin{bmatrix} 4 & 0 \\ 0 & -3 \end{bmatrix}^{-1} = \begin{bmatrix} \frac{1}{4} & 0 \\ 0 & -\frac{1}{3} \end{bmatrix}$

Wyliczymy od razu $D^{-1}b$ oraz $1-D^{-1}A$, ponieważ pozostają niezmienne pomiędzy iteracjami.

$D^{-1}b=\begin{bmatrix} \frac{1}{4} & 0 \\ 0 & -\frac{1}{3} \end{bmatrix}*\begin{bmatrix} 1 \\ 5 \end{bmatrix} = \begin{bmatrix} \frac{1}{4} \\ -\frac{5}{3} \end{bmatrix}$\\
$1-D^{-1}A = \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}-\begin{bmatrix} \frac{1}{4} & 0 \\ 0 & -\frac{1}{3} \end{bmatrix}*\begin{bmatrix} 4 & -2 \\ 0 & -3 \end{bmatrix} = \begin{bmatrix} 0 & \frac{1}{2} \\ 0 & 0 \end{bmatrix}$\\

Kuaaro fact: Pamiętajcie kochani, że jak w Wolframie zrobicie $1-A$, to to nie jest $\begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix} - A$ tylko $\begin{bmatrix} 1 & 1 \\ 1 & 1 \end{bmatrix} - A$ (Cries in a lost hour).

Wzór iteracyjny dla tych równań: $x_{i+1}=\begin{bmatrix} 0 & \frac{3}{2} \\ 1 & 0 \end{bmatrix}*x_i+\begin{bmatrix} \frac{1}{4} \\ -\frac{5}{3} \end{bmatrix}$\\
$x_1=\begin{bmatrix} 0 & \frac{1}{2} \\ 0 & 0 \end{bmatrix}*\begin{bmatrix} 0 \\ 0 \end{bmatrix}+\begin{bmatrix} \frac{1}{4} \\ -\frac{5}{3} \end{bmatrix} = \begin{bmatrix} \frac{1}{4} \\ -\frac{5}{3} \end{bmatrix}$\\
$x_2=\begin{bmatrix} 0 & \frac{1}{2} \\ 0 & 0 \end{bmatrix}*\begin{bmatrix} \frac{1}{4} \\ -\frac{5}{3} \end{bmatrix}+\begin{bmatrix} \frac{1}{4} \\ -\frac{5}{3} \end{bmatrix} = \begin{bmatrix} -\frac{7}{12} \\ -\frac{5}{3} \end{bmatrix}$\\
$x_3=\begin{bmatrix} 0 & \frac{1}{2} \\ 0 & 0 \end{bmatrix}*\begin{bmatrix} -\frac{7}{12} \\ -\frac{5}{3} \end{bmatrix}+\begin{bmatrix} \frac{1}{4} \\ -\frac{5}{3} \end{bmatrix} = \begin{bmatrix} -\frac{7}{12} \\ -\frac{5}{3} \end{bmatrix}$\\

Skoro iteracje się nie zmieniają, mamy rozwiązanie:

\begin{equation*}\begin{cases}
    x_1=-\frac{7}{12}\\
    x_2=-\frac{5}{3}
\end{cases}\end{equation*}

\subsection{Dekompozycja LU (liniowe)}
Ogólny wzór: $Ax=b\:=>\:LRx=b$, gdzie $LR=A$, L i R to macierze odpowiednio dolno i górno trujkątne.\\
Następnie rozwiązujemy 2 ukłądy równań: $Ly=b$ oraz $Rx=y$.
Rozwiązać:

\begin{equation*}\begin{cases}
    x_1+x_2+x_3=6\\
    x_1-x_2+x_3=2\\
    -x_1+x_2+x_3=4
\end{cases}\end{equation*}

\subsubsection{Metoda Crouta-Doolittle'a}
Rozpisana metoda Doolittle'a, użyć tamtego, bazgroły zakomentowane w Latexie.
%\textbf{Stworzenie macierzy}\\
%$A=LR=\begin{bmatrix} 1 & 0 & 0 \\ l_{21} & 1 & 0 \\ l_{31} & l_{32} & 1 \end{bmatrix} \begin{bmatrix} r_{11} & r_{12} & r_{13} \\ 0 & r_{22} & r_{23} \\ 0 & 0 & r_{33} \end{bmatrix}$\\
%Kopiujemy pierwszy rząd macierzy A do pierwszego rzędu macierzy R.\\
%$\begin{bmatrix} 1 & 1 & 1 \\ 1 & -1 & 1 \\ -1 & 1 & 1 \end{bmatrix}=\begin{bmatrix} 1 & 0 & 0 \\ l_{21} & 1 & 0 \\ l_{31} & l_{32} & 1 \end{bmatrix} \begin{bmatrix} 1 & 1 & 1 \\ 0 & r_{22} & r_{23} \\ 0 & 0 & r_{33} \end{bmatrix}$\\
%Dzielimy wartości w pierwszej kolumnie A przez $r_{11}$ i wpisujemy do macierzy L ($r_{11}=1$, ale pokazuję krok po kroku, jakby nie było).\\
%$l_{21}=\frac{a_{21}}{r_{11}}=\frac{-1}{1}=-1\\l_{31}=\frac{a_{31}}{r_{11}}=\frac{-1}{1}=-1$\\
%$\begin{bmatrix} 1 & -1 & -1 \\ -1 & 1 & -1 \\ -1 & 1 & 1 \end{bmatrix}=\begin{bmatrix} 1 & 0 & 0 \\ -1 & 1 & 0 \\ -1 & l_{32} & 1 \end{bmatrix} \begin{bmatrix} 1 & -1 & -1 \\ 0 & r_{22} & r_{23} \\ 0 & 0 & r_{33} \end{bmatrix}$\\
%Każdą wartość w 2gim rzędzie macierzy R wyliczamy, odejmując od wartości a w tym samym miejscu iloczyn wartości r nad nią i wartość l na lewo.\\
%$r_{22}=a_{22}-l_{21}r_{12}=1-(-1)(-1)=0\\r_{23}=a_{23}-l_{21}r_{13}=-1-(-1)(-1)=-2$\\
%$\begin{bmatrix} 1 & -1 & -1 \\ -1 & 1 & -1 \\ -1 & 1 & 1 \end{bmatrix}=\begin{bmatrix} 1 & 0 & 0 \\ -1 & 1 & 0 \\ -1 & l_{32} & 1 \end{bmatrix} \begin{bmatrix} 1 & -1 & -1 \\ 0 & 0 & -2 \\ 0 & 0 & r_{33} \end{bmatrix}$\\
%$l_{32}=\frac{(a_{32}-l_{31}r_{12})}{r_{22}}=\frac{1-(-1)(-1)}{0}=\frac{0}{0}=1$\\
%Uwaga: Możliwe że jak algorytm chce podzielić przez 0, to trzeba zmienić kolejność równań.
%$\begin{bmatrix} 1 & -1 & -1 \\ -1 & 1 & -1 \\ -1 & 1 & 1 \end{bmatrix}=\begin{bmatrix} 1 & 0 & 0 \\ -1 & 1 & 0 \\ -1 & 1 & 1 \end{bmatrix} \begin{bmatrix} 1 & -1 & -1 \\ 0 & 0 & -2 \\ 0 & 0 & r_{33} \end{bmatrix}$\\
%$r_{33}=a_{33}-l_{31}r_{13}-l_{32}r_{23}=1-(-1)(-1)-(0)(-2)=2$\\
%$\begin{bmatrix} 1 & -1 & -1 \\ -1 & 1 & -1 \\ -1 & 1 & 1 \end{bmatrix}=\begin{bmatrix} 1 & 0 & 0 \\ -1 & 1 & 0 \\ -1 & 1 & 1 \end{bmatrix} \begin{bmatrix} 1 & -1 & -1 \\ 0 & 0 & -2 \\ 0 & 0 & 2 \end{bmatrix}$\\
%Sprawdzamy czy się dobrze wymnarza $LR=A$ (dobrze).

%\textbf{Rozwiązanie równań}\\
%$\begin{bmatrix} 1 & 0 & 0 \\ -1 & 1 & 0 \\ -1 & 1 & 1 \end{bmatrix}\begin{bmatrix} y_1 \\ y_2 \\ y_3 \end{bmatrix} = \begin{bmatrix} 1 \\ 2 \\ -1 \end{bmatrix}$\\
%$y_1=1\\y_2=2-(-y_1)=3\\y_3=-1-(-y_1)-(y_2)=-3$\\
%$\begin{bmatrix} 1 & -1 & -1 \\ 0 & 0 & -2 \\ 0 & 0 & 2 \end{bmatrix}\begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix} = \begin{bmatrix} 1 \\ 3 \\ -3 \end{bmatrix}$\\

%\begin{equation*}\begin{cases}
%    x_1=x_2-\frac{1}{2}\\
%    x_3=-\frac{3}{2}
%\end{cases}\end{equation*}

\subsubsection{Metoda Doolittle'a}
\textbf{Stworzenie macierzy}\\
Uwaga: Jak podczas tworzenia macierzy pojawi się 0 na diagonalnej, to trzeba zmieniać rzędy i kolumny, żeby usunąć 0 z diagonalnej. \\

$A=LR=\begin{bmatrix} l_{11} & 0 & 0 \\ l_{21} & l_{22} & 0 \\ l_{31} & l_{32} & l_{33} \end{bmatrix} \begin{bmatrix} 1 & r_{12} & r_{13} \\ 0 & 1 & r_{23} \\ 0 & 0 & 1 \end{bmatrix}$\\
W tym algorytmie modyfikujemy macierz A, w taki sposób że wartości L są na i pod diagonalną, a wartości R są nad diagonalną.\\
$A=\begin{bmatrix} 1 & 1 & 1 \\ 1 & -1 & 1 \\ -1 & 1 & 1 \end{bmatrix}$\\
Dzielimy wszystkie elementy w pierwszym rzędzie na prawo od diagonalnej przez diagonalną.\\
$A=\begin{bmatrix} 1 & 1 & 1 \\ 1 & -1 & 1 \\ -1 & 1 & 1 \end{bmatrix}$\\
Iterujemy po wszystkich wartościach, które są pod pierwszym rzędem i na prawo od pierwszej kolumny zgodnie ze wzorem $a_{ij}=a_{ij}-a_{i1}a_{1j}$.\\ 
$a_{22}=a_{22}-a_{21}a_{12}=-1-(1)(1)=-2$\\
$a_{23}=a_{23}-a_{21}a_{13}=1-(1)(1)=0$\\
$a_{32}=a_{32}-a_{31}a_{12}=1-(1)(-1)=2$\\
$a_{33}=a_{33}-a_{31}a_{13}=-1-(1)(-1)=2$\\

$A=\begin{bmatrix} 1 & 1 & 1 \\ 1 & -2 & 0 \\ -1 & 2 & 2 \end{bmatrix}$\\

Znowu dzielimy elementy na prawo przez diagonalną, a że $a_{32}=0$, to nic nie robimy.\\
Znowu dla elementów poniżej 2giego rzędu i na prawo od 2giej kolumny wykonujemy działanie $a_{ij}=a_{ij}-a_{i2}a_{2j}$, $a_{32}=0$, więc znów nic się nie zmienia.\\
Rozbijamy macierz na L i R:\\

$A=\begin{bmatrix} 1 & 0 & 0 \\ 1 & -2 & 0 \\ -1 & 2 & 2 \end{bmatrix}\begin{bmatrix} 1 & 1 & 1 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}$

\textbf{Rozwiązanie równań}\\
$Ly=b$\\
$\begin{bmatrix} -1 & 0 & 0 \\ -1 & -2 & 0 \\ 1 & 2 & 2 \end{bmatrix}\begin{bmatrix} y_1 \\ y_2 \\ y_3 \end{bmatrix} = \begin{bmatrix} 6 \\ 2 \\ 4 \end{bmatrix}$

\begin{equation*}\begin{cases}
    y_1=6\\
    y_2=2\\
    y_3=3
\end{cases}\end{equation*}

$\begin{bmatrix} 1 & 1 & 1 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}\begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix} = \begin{bmatrix} 6 \\ 2 \\ 3 \end{bmatrix}$

\begin{equation*}\begin{cases}
    x_1=1\\
    x_2=2\\
    x_3=3
\end{cases}\end{equation*}

\subsection{Gaussa-Seidla (Liniowe), chyba dotąd nie było tego na żadnym egzaminie}
Wzór: $$x{i+1}= - (L+D)^{-1}Ux{k} + (L+D)^{-1}b$$\\

Pomocne są macierze pomocnicze: $B = -(L+D)^{-1}U$, $C = (L+D)^{-1}b$ \\
Uwaga 1: Macierz musi być dodatnio określona. \\
Uwaga 2: ta metoda działa wtedy, kiedy wyznacznik macierzy $B = (L+D)^{-1}U$
ma jedno rozwiązanie (metoda jest zbierzna). \\ 
ACC fact: jeżeli macierz jest dominująca diagonalnie, dowolny punkt startowy 
da nam odpowiedź. Jeżeli nie, czasami punkt startowy może dać wynik, czasami nie.

O wiele łatwiej jest wykorzystywać wzór na poszczególne elementy:
$x^{k+1}{i} = \frac{b_k \sum{j=1}^{i-1}a{ij}x_j^(k+1) - \sum{j=i+1}^na{ij}x_j^k}{a{ii}} $
ale ja nie lubię chodzić na łatwiznę

Uwaga - z uwagi na dzielenie, wartość diagonalna nie może być zerowa.

\subsubsection{
\begin{equation*}\begin{cases}
    3x_1+4x_2=1\\
    x_1+2x_2+x_3=0\\
    2x_2+6x_3=1
\end{cases}\end{equation*}}
Wektor startowy standardowo damy
$x_0 = \begin{bmatrix} 0 \\ 0 \\ 0 \end{bmatrix} $

Podzielmy macierze na części (L+D) i U:\\
ACC fact: to nie jest ten sam podział, co dekompozycja LU. Tutaj L to macierz dolnotrójkątna, D to macierz diagonalna, U to macierz górnotrójkątna.

$(L+D) = \begin{bmatrix}3&0&0\\1&2&0\\0&2&6\end{bmatrix}$,
$U = \begin{bmatrix}0&4&0\\0&0&1\\0&0&0\end{bmatrix}$

Wyznaczamy odwrotność macierzy (L+D), krokami:
\begin{enumerate}
    \item wyznacznik: $det(L+D) = 326 + 120 + 000 - 020-023-016 = 36$ 
    \item macierz dopełnień algebraicznych (wyszukajcie sposób):
$ (L+D)^D = 
\begin{bmatrix}
    12 & -6 & 2 \\
    0 & 18 & -6 \\
    0 & 0 & 6
\end{bmatrix}
$
    \item transponujemy i dzielimy przez det(L+D) (czyt. podziel każdy element przez det(L+D)) macierz dopełnień, aby otrzymać odwrotność:
$
(L+D)^{-1} = \frac{1}{det(L+D)}
\begin{bmatrix}
    12 & 0 & 0 \\
    -6 & 18 & 0 \\
    2 & -6 & 6
\end{bmatrix}
=
\begin{bmatrix}
    \frac{1}{3} & 0 & 0 \\
    -\frac{1}{6} & \frac{1}{2} & 0 \\
    \frac{1}{18} & -\frac{1}{6} & \frac{1}{6}
\end{bmatrix}
$
\end{enumerate}
Wyznaczamy macierze pomocnicze B i C:

$
B = 
\begin{bmatrix}
    -\frac{1}{3} & 0 & 0 \\
    \frac{1}{6} & -\frac{1}{2} & 0 \\
    -\frac{1}{18} & \frac{1}{6} & -\frac{1}{6}
\end{bmatrix}
\begin{bmatrix}
    0 & 4 & 0 \\
    0 & 0 & 1 \\
    0 & 0 & 0 
\end{bmatrix} 
= 
\begin{bmatrix}
    0 & -\frac{4}{3} & 0 \\
    0 & \frac{2}{3} & -\frac{1}{2} \\
    0 & -\frac{2}{9} & \frac{1}{6} 
\end{bmatrix} 
\
C = 
\begin{bmatrix}
    \frac{1}{3} & 0 & 0 \\
    -\frac{1}{6} & \frac{1}{2} & 0 \\
    \frac{1}{18} & -\frac{1}{6} & \frac{1}{6}
\end{bmatrix}
\begin{bmatrix}
    1\\0\\1
\end{bmatrix}
=
\begin{bmatrix}
    \frac{1}{3}\\-\frac{1}{6}\\\frac{2}{9}
\end{bmatrix}
$

Uwaga - we wzorze na B jest MINUS $(L+D)^{-1}$.

Powyższe macierze podstawiamy z każdą iteracją do wzoru $x^{k+1} = Bx^k + C$:

$x^1 = Bx^0 + C = C = \begin{bmatrix}\frac{1}{3}\\-\frac{1}{6}\\\frac{2}{9}\end{bmatrix} $ \\
$x^2 = Bx^1 + C = 
\begin{bmatrix}0 & -\frac{4}{3} & 0 \\0 & \frac{2}{3} & -\frac{1}{2} \\0 & -\frac{2}{9} & \frac{1}{6}\end{bmatrix}
\begin{bmatrix}\frac{1}{3}\\-\frac{1}{6}\\\frac{2}{9}\end{bmatrix}
+ \begin{bmatrix}\frac{1}{3}\\-\frac{1}{6}\\\frac{2}{9}\end{bmatrix}  = \begin{bmatrix}\frac{4}{9}\\-\frac{21}{54}\\\frac{8}{27}\end{bmatrix}$

\section{SOR (Metoda Sukcesywnej Relaksacji)(Liniowe)}
\textbf{WORK IN PROGRESS}\\
DLC dla metody Gaussa-Seidla, gdzie $B(\omega)=\frac{1}{\omega}D(I-\omega D^{-1}E)$, $\omega$ powinno być $0<\omega<2$.\\
Ogólny wzór dla  $B(\omega)$, gdzie $E=\begin{bmatrix} 0 & 0 & 0 \\ e_1 & 0 & 0 \\ e_2 & e_3 & 0 \end{bmatrix}$, $D=\begin{bmatrix} d_1 & 0 & 0 \\ 0 & d_2 & 0 \\ 0 & 0 & d_3 \end{bmatrix}$, $B(\omega) = \begin{bmatrix} \frac{d_1}{\omega} & 0 & 0 \\ -e_1 & \frac{d_2}{\omega} & 0 \\ -e_2 & -e_3 & \frac{d_3}{\omega} \end{bmatrix}$

\subsection{
\begin{equation*}\begin{cases}
    x_1+x_2+x_3=6\\
    x_1-x_2+x_3=2\\
    -x_1+x_2+x_3=4
\end{cases}\end{equation*}}
Dla tego przykładu nie widać dużej różnicy od zwykłego Gaussa-Seidla, bo są same 1.\\
$A=\begin{bmatrix} 1 & 1 & 1 \\ 1 & -1 & 1 \\ -1 & 1 & 1 \end{bmatrix}$\\
$D=\begin{bmatrix} 1 & 0 & 0 \\ 0 & -1 & 0 \\ 0 & 0 & 1 \end{bmatrix}$\\
$D^{-1}=D$, jakby D miało wartości inne niż 1 lub -1, to dla D wystarczy wziąć odwrotność każdego z elementów.\\
$E=\begin{bmatrix} 0 & 0 & 0 \\ -1 & 0 & 0 \\ 1 & -1 & 0 \end{bmatrix}$

\subsubsection{$\omega=1.5$}
$B(1.5)=\frac{1}{1.5}D(I-1.5D^{-1}E)$\\
$B(1.5)=\frac{1}{1.5}\begin{bmatrix} 1 & 0 & 0 \\ 0 & -1 & 0 \\ 0 & 0 & 1 \end{bmatrix}(\begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}-1.5\begin{bmatrix} 1 & 0 & 0 \\ 0 & -1 & 0 \\ 0 & 0 & 1 \end{bmatrix}\begin{bmatrix} 0 & 0 & 0 \\ -1 & 0 & 0 \\ 1 & -1 & 0 \end{bmatrix})=\begin{bmatrix} \frac{2}{3} & 0 & 0 \\ 1 & -\frac{2}{3} & 0 \\ -1 & 1 & \frac{2}{3} \end{bmatrix}$


\subsubsection{$\omega=1.2$}
$B(1.2)=\frac{1}{1.2}D(I-1.2D^{-1}E)$\\
$B(1.2)=\frac{1}{1.2}\begin{bmatrix} 1 & 0 & 0 \\ 0 & -1 & 0 \\ 0 & 0 & 1 \end{bmatrix}(\begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}-1.2\begin{bmatrix} 1 & 0 & 0 \\ 0 & -1 & 0 \\ 0 & 0 & 1 \end{bmatrix}\begin{bmatrix} 0 & 0 & 0 \\ -1 & 0 & 0 \\ 1 & -1 & 0 \end{bmatrix})=\begin{bmatrix} \frac{5}{6} & 0 & 0 \\ 1 & -\frac{5}{6} & 0 \\ -1 & 1 & \frac{5}{6} \end{bmatrix}$

Reszta jak w Gaussie

%\section{Tabelki}
%\begin{table}[H]
%\centering
%\begin{tabular}{|l|l|l|}
%    \hline
%    Funkcja & Pochodna & Całka \\
%    \hline $( f(x) = \sin(x) )$ & $( f'(x) = \cos(x) )$ & $( F(x) = -\cos(x) )$ \\
%    \hline $( g(x) = \cos(x) )$ & $( g'(x) = -\sin(x) )$ & $( G(x) = \sin(x) )$ \\
%    \hline $( h(x) = \tan(x) )$ & $( h'(x) = \sec^2(x) )$ & $( H(x) = -\ln|\cos(x)| )$ \\
%    \hline $( j(x) = \arcsin(x) )$ & $( j'(x) = \frac{1}{\sqrt{1-x^2}} )$ & $( J(x) = x\arcsin(x) + \sqrt{1-x^2} )$ \\
%    \hline $( k(x) = \arccos(x) )$ & $( k'(x) = -\frac{1}{\sqrt{1-x^2}} )$ & $( K(x) = x\arccos(x) - \sqrt{1-x^2} )$ \\
%    \hline $( l(x) = \arctan(x) )$ & $( l'(x) = \frac{1}{1+x^2} )$ & $( L(x) = \frac{1}{2}\ln(1+x^2) )$ \\
%    \hline $( m(x) = \sinh(x) )$ & $( m'(x) = \cosh(x) )$ & $( M(x) = \sinh(x) )$ \\
%    \hline $( n(x) = \cosh(x) )$ & $( n'(x) = \sinh(x) )$ & $( N(x) = \cosh(x) )$ \\
%    \hline $( p(x) = \tanh(x) )$ & $( p'(x) = \operatorname{sech}^2(x) )$ & $( P(x) = \ln(\cosh(x)) )$ \\
%    \hline
%\end{tabular}
%\end{table}

\section{Całki}
\subsection{Gauss/Gauss-Legendre}
\subsubsection{Tabelka z wartościami}
\begin{table}[H]
\resizebox{0.5\textwidth}{!}{%
\begin{tabular}{|c|c|c|}
\hline
n                  & $w_i$                   & $x_i$                         \\ \hline
1                  & $w_1=2$                 & $x_1=0$                       \\ \hline
2                  & $w_1=w_2=1$             & $x_2=-x_1=\sqrt{\frac{1}{3}}$ \\ \hline
\multirow{2}{*}{3} & $w_1=w_3=\frac{5}{9}$   & $x_3=-x_1=\sqrt{\frac{3}{5}}$ \\ \cline{2-3} 
                   & $w_2=\frac{8}{9}$       & $x_2=0$                       \\ \hline
\multirow{2}{*}{4} & $w_1=w_4\approx 0.3479$ & $x_4=-x_1\approx 0.8611$      \\ \cline{2-3} 
                   & $w_2=w_3\approx 0.6521$ & $x_3=-x_2\approx 0.3400$      \\ \hline
\multirow{3}{*}{5} & $w_1=w_5\approx 0.2369$ & $x_5=-x_1\approx 0.9062$      \\ \cline{2-3} 
                   & $w_2=w_4\approx 0.4786$ & $x_4=-x_2\approx 0.5385$      \\ \cline{2-3} 
                   & $w_3=\frac{128}{225}$   & $x_3=0$                       \\ \hline
\end{tabular}}
\end{table}
\subsubsection{$\int_{0}^{\pi}sin(x)dx$}
\textbf{1. Zmiana przedziału na [-1, 1]}\\
$s=\int_{0}^{\pi}sin(x)dx=\frac{\pi-0}{2}\int_{-1}^{1}f(\frac{\pi-0}{2}u+\frac{\pi+0}{2})du$\\
\textbf{2. Użycie dwu-punktowego całkowania}\\
$s=\sum_{i=1}^{2}w_if(x_i)=\frac{\pi}{2}(1*sin[\frac{\pi}{2}(-\sqrt{\frac{1}{3}})+\frac{\pi}{2}]+1*sin[\frac{\pi}{2}\sqrt{\frac{1}{3}}+\frac{\pi}{2}])\approx\frac{\pi}{2}(0.6162+0.6162)\approx1.9358$\\
\textbf{3. Użycie trzy-punktowego całkowania}\\
$s=\sum_{i=1}^{3}w_if(x_i)=\frac{\pi}{2}(\frac{5}{9}sin[\frac{\pi}{2}(-\sqrt{\frac{3}{5}})+\frac{\pi}{2}]+\frac{8}{9}sin[\frac{\pi}{2}*0+\frac{\pi}{2}]+\frac{5}{9}sin[\frac{\pi}{2}\sqrt{\frac{3}{5}}+\frac{\pi}{2}])\approx\frac{\pi}{2}(\frac{5}{9}*0.3467+\frac{8}{9}*1+\frac{5}{9}*0.3467)\approx2.0014$\\
\textbf{4. Błędy}\\
Wartość dokładna: $\int_{0}^{\pi}sin(x)dx=-cos(x)|^\pi_0=-cos(\pi)+cos(0)=-(-1)+1=2$\\
Błąd dla dwu-punktowego całkowania - $|\epsilon_t| = |\frac{2-1.9358}{2}|*100\% = 3.21\%$\\
Błąd dla trzy-punktowego całkowania - $|\epsilon_t| = |\frac{2-2.0014}{2}|*100\% = 0.07\%$

\subsubsection{$\int_{0}^{3}x^2dx$}
\textbf{1. Zmiana przedziału na [-1, 1]}\\
$s=\int_{0}^{3}x^2dx=\frac{3-0}{2}\int_{-1}^{1}f(\frac{3-0}{2}u+\frac{3+0}{2})du$\\
\textbf{2. Użycie dwu-punktowego całkowania}\\
$s=\sum_{i=1}^{2}w_if(x_i)=\frac{3-0}{2}(1*[\frac{3-0}{2}(-\sqrt{\frac{1}{3}})+\frac{3+0}{2}]^2+1*[\frac{3-0}{2}(\sqrt{\frac{1}{3}})+\frac{3+0}{2}]^2)=\frac{3}{2}(3+\cancel{\frac{9}{2}\sqrt{\frac{1}{3}}}+3\cancel{-\frac{9}{2}\sqrt{\frac{1}{3}}})=9$\\
\textbf{3. Błędy}\\
Wartość dokładna: $\int_{0}^{3}x^2dx=\frac{x^3}{3}|^3_0=\frac{27}{3}-\frac{0}{3}=9$\\
Błąd - $|\epsilon_t| = |\frac{9-9}{9}|*100\% = 0\%$\\
Jako że aproksymujemy wielomian drugiego stopnia ($x^2$) za pomocą wielomianu drugiego stopnia (Legendre'a), to błąd jest równy 0\%, ponieważ za pomocą wielomianu Legendre'a można idealnie pokryć $x^2$.\\

\subsection{Simpson/Parabol}
\subsubsection{Dla parzystej liczby przedziałów}
Dla 2n przedziałów bierzemy 2n+1 punktów tak, żeby pierwszy i ostatni były na początku i końcu przedziału, a pozostałe były równo od siebie oddalone. Następnie, wyliczamy wartości funkcji w punktach. Wartości funkcji mnożymy przez 2 jeżeli są nieparzyste, z wyjątkiem początku i końca przedziału, które mnożymy przez 1, oraz przez 4 jeżeli są nieparzyste. Na koniec mnożymy sumę wyników funkcji przez przedział oraz dzielimy przez sumę "mnożników", przez które pomnożyliśmy wyniki funkcji.\\
Błąd: $E\approx-\frac{N}{180}(\frac{b-a}{N})^5*avg\{\frac{d^4}{dx^4}f(x)\}$, gdzie $N$ to liczba przedziałów.\\
\textbf{Dla funkcji $\int_{0}^{\pi}sin(x)dx$}\\
Wartość idealna: $-cos(x)|^\pi_0=-cos(\pi)-(-cos(0))=2$\\
\textbf{Dla 2 przedziałów}\\
Punkty: $p \in \{0, \frac{\pi}{2}, \pi\}$\\
Wartości funkcji: $f(p) \in \{sin(0)=0, sin(\frac{\pi}{2})=1, sin(\pi)=0\}$\\
Mnożenie wartości funkcji: $m*f(p) \in \{1*0, 4*1, 1*0\}$\\
Wartość do pomnożenia sumy funkcji: $\frac{\pi-0}{1+4+1}=\frac{\pi}{6}$\\
Wartość całki: $\frac{\pi}{6}4=\frac{2\pi}{3}=2.0944$\\
\textbf{Dla 4 przedziałów}\\
Punkty: $p \in \{0, \frac{\pi}{4}, \frac{\pi}{2}, \frac{3\pi}{4}, \pi\}$\\
Wartości funkcji: $f(p) \in \{sin(0)=0, sin(\frac{\pi}{4})=\frac{\sqrt{2}}{2}, sin(\frac{\pi}{2})=1, sin(\frac{3\pi}{4})=\frac{\sqrt{2}}{2}, sin(\pi)=0\}$\\
Mnożenie wartości funkcji: $m*f(p) \in \{1*0, 4*\frac{\sqrt{2}}{2}, 2*1, 4*\frac{\sqrt{2}}{2}, 1*0\}$\\
Wartość do pomnożenia sumy funkcji: $\frac{\pi-0}{1+4+2+4+1}=\frac{\pi}{12}$\\
Wartość całki: $\frac{\pi}{12}(2*\sqrt{2}+2+2*\sqrt{2})=\frac{\pi}{6}(2\sqrt{2}+1)=2.0046$\\
Błąd względny: $E\approx-\frac{4}{180}(\frac{\pi-0}{4})^5*\frac{\int_{0}^{\pi}(sin(x))dx}{\pi-0} = -\frac{\pi^4}{23040} \approx -0.0042$\\
Błąd bezwzględny: $\frac{E}{\int_{0}^{\pi}sin(x)dx}*100\%=\frac{E}{2}*100\% \approx 0.2114\%$\\
\textbf{Dla 6 przedziałów}\\
Punkty: $p \in \{0, \frac{\pi}{6}, \frac{\pi}{3}, \frac{\pi}{2}, \frac{2\pi}{3}, \frac{5\pi}{6}, \pi\}$\\
Wartości funkcji: $f(p) \in \{sin(0)=0, sin(\frac{\pi}{6})=\frac{1}{2}, sin(\frac{\pi}{3})=\frac{\sqrt{3}}{2}, sin(\frac{\pi}{2})=1, sin(\frac{2\pi}{3})=\frac{\sqrt{3}}{2}, \\sin(\frac{5\pi}{6})=\frac{1}{2}, sin(\pi)=0\}$\\
Mnożenie wartości funkcji: $m*f(p) \in \{1*0, 4*\frac{1}{2}, 2*\frac{\sqrt{3}}{2}, 4*1, 2*\frac{\sqrt{3}}{2}, 4*\frac{1}{2}, 1*0\}$\\
Wartość do pomnożenia sumy funkcji: $\frac{\pi-0}{1+4+2+4+2+4+1}=\frac{\pi}{18}$\\
Wartość całki: $\frac{\pi}{18}(2+\sqrt{3}+4+\sqrt{3}+2)=\frac{\pi}{9}(4+\sqrt{3})=2.0009$\\
\subsubsection{Dla nieparzystej liczby przedziałów}
\textbf{Dla funkcji $\int_{0}^{\pi}sin(x)dx$}\\
Wartość idealna: $-cos(x)|^\pi_0=-cos(\pi)-(-cos(0))=2$\\
\textbf{Dla 3 przedziałów}\\
Postępujemy tak samo, jak dla powyższych przykładów, ale używamy wag 1, 3, 3 i 1.\\
Punkty: $p \in \{0, \frac{\pi}{3}, \frac{2\pi}{3}, \pi\}$\\
Wartości funkcji: $f(p) \in \{sin(0)=0, sin(\frac{\pi}{3})=\frac{\sqrt{3}}{2}, sin(\frac{\pi}{3})=\frac{\sqrt{3}}{2}, sin(\pi)=0\}$\\
Mnożenie wartości funkcji: $m*f(p) \in \{1*0, 3*\frac{\sqrt{3}}{2}, 3*\frac{\sqrt{3}}{2}, 1*0\}$\\
Wartość do pomnożenia sumy funkcji: $\frac{\pi}{1+3+3+1}=\frac{\pi}{8}$\\
Wartość całki: $\frac{\pi}{8}(3\sqrt{3})=\frac{3\pi \sqrt{3}}{8}=2.0405$\\
\textbf{Dla 5 i więcej przedziałów}\\
Dzielimy przedziały na 3 i 2/resztę. Używamy algorytmu dla 3 przedziałów dla początku i 2/reszty dla końca.
Punkty: $p \in \{0, \frac{\pi}{5}, \frac{2\pi}{5}, \frac{3\pi}{5}, \frac{4\pi}{5}, \pi\}$\\
Wartości funkcji: $f(p) \in \{sin(0)=0, sin(\frac{\pi}{5})\approx 0.5878, sin(\frac{2\pi}{5})\approx 0.9511, sin(\frac{3\pi}{5})\approx 0.9511,\\ sin(\frac{4\pi}{5})\approx 0.5878, sin(\pi)=0\}$\\
Wartości do pomnożenia sumy funkcji:\\
Dla 3: $\frac{\frac{3\pi}{5}-0}{1+3+3+1}=\frac{3\pi}{40}$\\
Dla 2: $\frac{\pi-\frac{3\pi}{5}}{1+4+1}=\frac{\pi}{15}$\\
Rozbicie na 3 i 2 przedziały: $\frac{3\pi}{40}(1*0+3*0.5878+3*0.9511+1*0.9511) + \frac{\pi}{15}(1*0.9511+4*0.5878+1*0)=2.0034$

\section{Równania różniczkowe}
\subsection{Metoda ekstrapolacyjna Eulera}
Dane w zadaniach są zadawane w formie: $y'=f(x, y)$, $y(x_0)=y_0$, $h=h$.\\
\textbf{Otwarta}\\
Dla funkcji f(x, y) i skoku h wartość $y_{i+1}=y_i+h*f(x_0+i*h, y_i)$\\
Wzory do wykorzystania w Desmosie:\\
$
g(i)=\{i=0:y_0,g(i-1)+h*f(x_0+(i-1)h, g(i-1))\}\\
f(x,y)=xy\\
y_0=1\\
h=0.5\\
x_0=0\\
g(3)\\
$\\
Wszystko poza pierwszą linijką można modyfikować.\\
\textbf{Zamknięta}\\
Dla funkcji f(x, y) i skoku h wartość $y_{i+1}=y0_i+h*f(x_0+(i+1)*h, y_{i+1})$\\

\subsubsection{Dla $f(x,y)=xy$, $x_0=0$, $y_0=1$, $h=0.5$ wyznacz 3 pierwsze iteracje obydwoma metodami.}
\textbf{Otwarta/Ekstrapolacyjna}\\
$y_1=y_0+h*f(x_0+0*h, y_0)=1+0.5*0*1=1$\\
$y_2=y_1+h*f(x_0+1*h, y_1)=1+0.5*0.5*1=1.25$\\
$y_3=y_2+h*f(x_0+2*h, y_2)=1.25+0.5*1*1.25=1.875$\\
\textbf{Zamknięta}\\
$y_1=y_0+h*f(x_0+1*h, y_1)=1+0.5*0.5*y_1 => y_1=\frac{4}{3}$\\
$y_2=y_1+h*f(x_0+2*h, y_2)=\frac{4}{3}+0.5*1*y_2 => y_2=\frac{8}{3}$\\
$y_3=y_2+h*f(x_0+3*h, y_3)=\frac{8}{3}+0.5*1.5*y_3 => y_3=\frac{32}{3}$\\

\section{Ocena zbierzności algortmu iteracyjnego}
\subsection{$x_{i+1}=\frac{1}{7}(6x_i+\frac{a}{x_i^6})$, $x=\sqrt[7]{a}$}
Zastępujemy $x_i$ za pomocą $x_\infty$, czyli zakładamy że w nieskończonej iteracji otrzymamy poprawne wyniki.\\
$\frac{1}{7}(6x_\infty+\frac{a}{x_\infty^6})$\\
Warunkiem zbieżności jest:
\begin{equation*}\begin{cases}
    p=1, |c|<1\\
    p=2,3,..., |c|<\infty
\end{cases}\end{equation*}
gdzie: $c=\frac{1}{p!}f^{(p)}(x_\infty)$\\
Bierzemy pochodną p=1 z funkcji: $f^{(1)}=\frac{6}{7}(1-\frac{a}{x_\infty^7})=\frac{6}{7}(1-\frac{a}{a})=0$\\
Bierzemy pochodną p=2 z funkcji: $f^{(2)}=\frac{6}{7}(42\frac{a}{x_\infty^8})=6\frac{a}{a\sqrt[7]{a}} = \frac{6}{\sqrt[7]{a}}\neq 0$\\
Jako że p=2, to funkcja jest zbierzna kwadratowo.

\section{Poprawny numerycznie algorytm obliczania wartości wyrażenia $y=\frac{1}{x}(1-\frac{\sqrt{2}}{\sqrt{2+x}});||x||<<1$}
$y=\frac{1}{x}(1-\frac{\sqrt{2}}{\sqrt{2+x}})$\\
$y=\frac{1}{x}(\frac{\sqrt{2+x}}{\sqrt{2+x}}-\frac{\sqrt{2}}{\sqrt{2+x}})=\frac{1}{x}\frac{\sqrt{2+x}-\sqrt{2}}{\sqrt{2+x}}$\\
$y=\frac{1}{x}\frac{\sqrt{2+x}-\sqrt{2}}{\sqrt{2+x}}\frac{\sqrt{2+x}+\sqrt{2}}{\sqrt{2+x}+\sqrt{2}}=\frac{1}{x}\frac{2+x-2}{2+x+\sqrt{2}\sqrt{2+x}}=\frac{1}{x}\frac{x}{2+x+\sqrt{2}\sqrt{2+x}}=\frac{1}{2+x+\sqrt{4+2x}}$\\
Błędy:
\begin{enumerate}
    \item $2+x$
    \item $2x$
    \item $\sqrt{4+2x}$
    \item $2+x+\sqrt{4+2x}$
    \item $\frac{1}{2+x+\sqrt{4+2x}}$
\end{enumerate}
Błąd graniczny $\overset{\sim}{y}=(2+x)(1+\eta_z)^{-1}$

\section{Oszacuj błąd względny (błąd graniczny) wyznaczania wartości wyrażenia}
Błąd danych: $\delta(\overset{\sim}{y})=\frac{x}{f(x)}*f'(x)*\epsilon_x$\\
Błąd zaokrągleń: $f(x)\prod_{i=0}^{n}(1-\eta_i)$, gdzie $\eta_i$ to kolejne błędy przy każdym działaniu, które wymaga użycia x w f(x)\\
\subsection{$y=x^2sin(x)$}
$y'=2xsin(x)+x^2cos(x)$\\
Błąd danych: $\delta(\overset{\sim}{y})=\frac{x}{x^2sin(x)}*x(2sin(x)+xcos(x))*\epsilon_x=(2-x*ctg(x))\epsilon_x$\\
Błędy zaokrągleń:
\begin{itemize}
    \item $x^2 => x^2(1-\eta_1)$
    \item $sin(x) => sin(x)(1-\eta_2)$
    \item $x^2sin(x) => x^2sin(x)(1-\eta_3)$
\end{itemize}
Błąd zaokrągleń: $\overset{\sim}{y}=x^2sin(x)(1-\eta_1)(1-\eta_2)(1-\eta_3)$\\

\subsection{$y=x^3sin(x)$}
$y'=x^2(3sin(x)+x*cos(x))$\\
Błąd danych: $\delta(\overset{\sim}{y})=\frac{x}{x^3sin(x)}*x^2(3sin(x)+x*cos(x))*\epsilon_x=(3+x*ctg(x))\epsilon_x$\\
Błędy zaokrągleń:
\begin{itemize}
    \item $x^3 => x^3(1-\eta_1)(1-\eta_2)$
    \item $sin(x) => sin(x)(1-\eta_3)$
    \item $x^3sin(x) => x^2sin(x)(1-\eta_4)$
\end{itemize}
Błąd zaokrągleń: $\overset{\sim}{y}=x^3sin(x)(1-\eta_1)(1-\eta_2)(1-\eta_3)(1-\eta_4)$\\
\section{Uwarunkowanie zadania}
Przekształcamy równanie, żeby po jednej stronie był x:\\
$ln(ax)=-b => e^{ln(ax)}=e^{-b} => ax = e^{-b} => \frac{e^{-b}}{a}$\\
Wskaźnik uwarunkowania dla równań to stosunek błędu względnego danych do błędu względnego rozwiązania.


\end{document}

